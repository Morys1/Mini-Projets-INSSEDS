---
title: "ANALYSE DES FACTEURS CONTRIBUANT AU DIAGNOSTIQUE DES MALADIES CARDIAQUES"
author: "M. Savané Mory"
date: "`r Sys.Date()`"
output:
  word_document: default
---

```{r echo=FALSE}
library(Mory)
library(visdat)
library(ggplot2)
library(DescTools)
library(data.table)
```

# INTRODUCTION GENERALE

Les données sont désormais une ressource essentielle pour les entreprises de tous secteurs.
À l'ère du Big Data, elles sont utilisées pour soutenir la prise de décision critique .
Dans le secteur médical, des données médiocres peuvent conduire à des traitements inappropriés, voire à l'échec du développement de médicaments.
Une étude d'Accenture révèle que le manque de données propres constitue le principal obstacle à l'adoption de l'IA dans ce domaine.

### SOMMAIRE

# PREMIERE PARTIE: PRETRAITEMENT DES DONNEES

## Introduction



### I. DESCRIPTION DES DONNEES

#### 1. Dictionnaire des donnees

L
Dans le cadre de notre etude ce document se presente comme suit:

| VARIABLE       | NATURE       | DESCRIPTION                                              | MODALITES                                                                                                              |
|:----------------|:----------------|:----------------|:----------------------|
| Age            | Quantitative | age du patient                                           | Numérique Entier en annees                                                                                             |
| Sex            | Qualitative  | sexe/genre du patient                                    | M : Masculin ou F: Feminin                                                                                             |
| ChestPainType  | Qualitative  | Type de douleur thoracique                               | TA: Angine de poitrine typique, ATA: Angine de poitrine atypique, NAP: Douleur autre que l'angine, ASY: Asymptomatique |
| RestingBP      | Quantitative | tension artérielle au repos (en mm Hg)                   | Numerique Decimal                                                                                                      |
| Cholesterol    | Quantitative | taux de cholestérol (en mm/dl)                           | Numerique Decimal                                                                                                      |
| FastingBS      | Qualitative  | glycémie à jeun                                          | qualitative Binaire (1 si FastingBS \> 120 mg/dl, 0 sinon)                                                             |
| RestingECG     | Qualitative  | électrocardiogramme au repos                             | LVH, Normal et ST                                                                                                      |
| MaxHR          | Quantitative | fréquence cardiaque maximale (en battements par minutes) | Numerique Decimal                                                                                                      |
| ExerciseAngina | Qualitative  | angine induite par l'exercice                            | Non.angine(Presence d angine apres exercice) et Oui.angine(Absence d angine apres exercice)                            |
| Oldpeak        | Quantitative | dépression du segment ST induite par l'exercice          | Numerique Decimal                                                                                                      |
| ST_Slope       | Qualitative  | pente du segment ST                                      | Up: croissante ; Flat : constante ; Down : décroissante                                                                |
| HeartDisease   | Qualitative  | présence ou absence de maladie cardiaque                 | Non ou Oui                                                                                                             |

#### 2. Visualisation du jeux de donnee brute et de sa structure

Avant de debuter tout analyse, il est primordial de faire une premiere visualisation des donnees dans le but de se faire une idee succinte de la repartition des donnees, des noms des differentes colonnes et de l agencement des differentes lignes.
Par ailleurs, cette premiere phase est appuyee par la visualisation de la structure et de la statistique descritive du dataframe.

```{r echo=FALSE}
setwd('C:/Users/THINKPAD/OneDrive/Bureau/Miniprojets/MiniProjet1')
data <- read.csv("cardiac.csv", header = TRUE, stringsAsFactors = TRUE, 
                  sep = ',', dec = '.')
```

```{r echo=FALSE}
df <- copy(data)
knitr::kable(df[1:5, ], caption = "Tableau 1: Releve cardiaque des patients")
#summary(df)
str(df)
```

Cette premiere analyse met a nu *quelques anomalies* au niveau des types des variables FastingBS et HeartDisease qui sont condideres comme des variables quantitatives alors qu elles sont qualitatives.
Nous allons donc les recoder en variables qualitatives.

##### \* Recodage de certaines variables

```{r echo=FALSE}
df$HeartDisease <- as.factor(ifelse(df$HeartDisease == 0, "Non", "Oui"))
```

```{r echo=FALSE}
df$FastingBS <- as.factor(ifelse(df$FastingBS == 1, "FastingBS > 120 mg/dl", "FastingBS < 120 mg/dl"))
```

```{r echo=FALSE}
df$Sex <- as.factor(ifelse(df$Sex == "M", "Homme", "Femme"))
```


```{r echo=FALSE}
df$ExerciseAngina <- factor(ifelse(df$ExerciseAngina=="N", "Non.angine", "Oui.angine"))
```

```{r echo=FALSE}
str(df)
```

Cet appercu nous permet de savoir que nous sommes en presence de 918 observations avec douze (12) variables dont 5 quantitatives et 7 qualitatives.

### II. TRAITEMENT DES VALEURS MANQUANTES, VALEURS ABERRANTES ET EXTREMES

Une valeur manquante est une donnee qui n est pas presente pour une variable du jeu de donnees soumis a notre analyse.
Il est generalement materialise dans les logiciels d analyse par **NA** (Not Availlable).

#### 1. Visualisation des donnees manquantes

```{r echo=FALSE}
par(mfrow=c(1, 2), mar=c(3, 3, 3, 3))
vis_miss(df)
vis_dat(df)
par(mfrow=c(1, 1), mar=c(0, 0, 0, 0))
```

Suite a la visualisation, nous remarquons que nos donnees sont examptes de valeurs manquantes, ce qui nous donne une avance considerable dans la suite de notre analyse.

#### 2. Visualisation des valeurs aberrantes et extremes

Nous debutons par extraire les variables quantitatives et ensuite, nous visualisons les boites a moustaches associees.

```{r echo=FALSE}
dfquant = extraire_variables_quantitatives(df)
knitr::kable(head(dfquant), caption = "Tableau des variables quantitatives")
```

```{r echo=FALSE}
#par(mfrow=c(3, 4), mar=c(1, 1, 1, 1))
boxplot(dfquant)
#boxplot(Cholesterol)
```

La visualisation des boites a moustache des variables quantitatives nous permet de focaliser notre attention sur deux principales variables: la variable *RestingBP* et la variable *Cholesterol*, car elles presentent des valeurs aberrantes.

##### a. Visualisation des valeurs aberrantes et extremes

```{r echo=FALSE}
pt <- ggplot(data = dfquant)
```

```{r echo=FALSE}
par(mfrow=c(2, 2), mar=c(2, 2, 2, 2))
Boxp.chol <- pt + geom_boxplot( mapping = aes(Cholesterol), outlier.color = "Red", fill = "yellow", colour = "blue", orientation = "y")
Boxp.chol

Boxp.RBP <- pt + geom_boxplot( mapping = aes(RestingBP), outlier.color = "Red", fill = "white", colour = "blue", orientation = "y")
Boxp.RBP
```

La visualisation approfondie des boites a moustache de ces deux variables confirme la presence de valeur aberrante et extrême.

Nous allons donc utiliser **la methode de winzorisation** pour ramener ces valeurs aux differentes bornes inferieurs et superieurs.

##### b. Traitement des valeurs aberrantes et extremes

###### \* Identification et traitement des valeurs aberrantes de la variable Cholesterol

```{r echo=FALSE}
df$Cholesterol <- Winsorize(df$Cholesterol)
boxplot(df$Cholesterol, main = "CHOLESTEROL APRES WINZORISATION", col = "yellow", border = "Red")
```

La methode de Winzorisation a traite les valeurs aberrantes de la moustache superieurs, mais a maintenue les individus ayant des valeurs egales à 0, qui sont effectivement des valeurs aberrantes.
Nous leur attribuerons la valeur de la moustache inferieur.

```{r echo=FALSE}
q1 <- quantile(df$Cholesterol, 0.25)
q3 <- quantile(df$Cholesterol, 0.75)
iqr.chol <- IQR(df$Cholesterol)
borne.inf <- q1 - 1.5*iqr.chol
```

```{r echo=FALSE}
df$Cholesterol[df$Cholesterol==0] <- borne.inf
head(df$Cholesterol[df$Cholesterol == borne.inf])
```

```{r echo=FALSE}
boxplot(df$Cholesterol, main = "CHOLESTEROL APRES ATTRIBUTION", col = "yellow", border = "Red")
```

La boite a moustache ci-dessus prouve que toutes les valeurs aberrantes et extremes ont ete traitees.

###### \* Identification et traitement des valeurs aberrantes de la variable RestingBP

Cette fois, l application de la methode de Winzorisation a permi de traiter toutes les valeurs aberrantes et extremes.
Nous obtenons le resultat suivant:

```{r echo=FALSE}
df$RestingBP <- Winsorize(df$RestingBP)
boxplot(df$RestingBP, main = "TENSION ARTERIELLE APRES WINZORISATION", col = "white", border = "blue")
```

### Conclusion

La phase de pretraitement de nos donnees nous a permis de les debarasser de tout ce qui pourrait mettre en question la pertinence des resultats obtenus à la suite de notre analyse.

# DEUXIEME PARTIE: ANALYSE UNIVARIEE

### Introduction

L Analyse univariee consiste a visualiser la distribution de nos donnees grâce a des graphiques adaptes a chaque type de variable et a calculer et interpreter les indicateurs de tendance centrale, les indicateurs de position et de forme.

### I. ANALYSE DES VARIABLES QUANTITATIVES

```{r echo=FALSE}
name.quant <- names(dfquant)
```

Les variables quantitatives presentent dans notre jeu de donnees sont: `r print(name.quant)`.
Pour chaque variable, l'analyse se fera en trois partie: la representation des donnees sous forme de graphique, sous forme de tableau numerique.
Par ailleurs, chaque partie sera accompagnee d une interpretation.

#### 1. Analyse et interpretation de l'âge des individus

```{r echo=FALSE}
pt.age <- ggplot(data = df)
Hist.age <- pt.age + 
  geom_histogram(mapping = aes(Age), colour = "white", fill = "blue", bins = 10) + 
  ylab("Nombre d'Individus") + 
  xlab("Age") +
  ggtitle("HISTOGRAMME DE LA VARIABLE AGE") +
  theme(plot.title = element_text(hjust = 0.5))
Hist.age
```

```{r echo=FALSE}
resume.age <- akposso.qt.resume(df$Age)
resume.age
```


La visualisation de l histogramme nous donne un appercu visuel de la repartition des donnees.
L age des individus de notre population est compris entre `r resume.age[["minimum"]]` ans et `r resume.age[["maximum"]]` ans.
Ils ont un age moyen s elevant a `r round(resume.age[["moyenne"]])` ans et demi, avec un ecart type d environ `r round(resume.age[["ecart_type"]])` ans.
De plus, un individu sur quatre a au moins de 47 ans tandis que l age median s eleve a `r round(resume.age[["mediane"]])` ans, c est a dire qu un individu sur deux a `r round(resume.age[["mediane"]])` ans.
Cela denote d une *population majoritairement adulte*.

Le tableau recapitulatif suivant permet d avoir de plus amples informations sur la repartition de cette paopulation.


| INDICATEUR        | VALEUR                    | INTERPRETATION                                                |
|-------------------|---------------------------|---------------------------------------------------------------|
| Minimum           | `r resume.age[["minimum"]]` | Le plus jeune individu est age de 28 ans                      |
| Maximum           |`r resume.age[["maximum"]]` | Le plus vieux individu est age de 77 ans                      |
| Moyenne           | `r round(resume.age[["moyenne"]])` | L'age moyen des individus est de 53.5                          |
| Mode              | `r round(resume.age[["mode"]])` | L'age qui se repete le plus est 54 ans                        |
| 1er quartile (Q1) | 47 ans                           | 25% des individus ont moins de 47 ans                         |
| Mediane (Q2)      | 54 ans                        | La moitie des individus ont plus de 54 ans ou moins de 54 ans |
| 3e quartile (Q3)  | 60 ans                         | 75% des individus ont moins de 47 ans                         |

: Tableau recapitulatif de la variable âge



## 2. Analyse et interpretation de la tension arterielle des individus (RestingBP)

La pression artérielle au repos représente la pression exercée par le sang sur les parois des artères lorsque le corps est au repos, en particulier *entre les battements cardiaques*.
Sa mesure se fait à l'aide d'un tensiomètre et est généralement prise lorsque la personne est assise ou allongée de manière confortable, et elle donne une indication de la pression sanguine de base dans le système circulatoire.
Une pression artérielle au repos *normale* est généralement autour de *120/80 mm Hg* (Millimetre de Mercure) où 80 mm Hg est la valeur de la frequence arterielle au repos.
La visualisation de l histogramme nous donne un appercu visuel de la repartition de la tension arterielle.

```{r echo=FALSE}
pt.RBP <- ggplot(data = df)
Hist.RBP <- pt.RBP + 
  geom_histogram(mapping = aes(df$RestingBP), colour = "white", fill = "#FFA500", bins = 10) + 
  ylab("Nombre d'Individus") + 
  xlab("Frequence arterielle (mm Hg)") +
  ggtitle("HISTOGRAMME DE LA TENSION ARTERIELLE AU REPOS") +
  theme(plot.title = element_text(hjust = 0.5))
Hist.RBP
```

```{r echo=FALSE}
resume.RBP <- akposso.qt.resume(df$RestingBP)
resume.RBP
```

La tension des individus de notre population est compris entre `r resume.RBP[["minimum"]]` mm Hg et `r resume.RBP[["maximum"]]` mm Hg, alors que la valeur modale est de 120 mm Hg.
Cela met en exergue que la plupart des personnes ont une *tension arterielle qui est autour de la normale*.

La frequence arterielle moyenne s'élève à `r round(resume.RBP[["moyenne"]])` mm Hg, avec un ecart type d environ `r round(resume.RBP[["ecart_type"]])` mm Hg.
De plus, un individu sur quatre a au plus 120 mm Hg tandis que la pression arterielle mediane est de `r round(resume.RBP[["mediane"]])` mm Hg, c est a dire qu un individu sur deux a `r round(resume.RBP[["mediane"]])` mm Hg, ce qui est relativement au dessus de la norme qui est 120 mm Hg.

Le tableau recapitulatif suivant permet d avoir de plus amples informations sur la repartition de cette paopulation.


| INDICATEUR        | VALEUR                    | INTERPRETATION                                                |
|-------------------|---------------------------|---------------------------------------------------------------|
| Minimum           | `r resume.RBP[["minimum"]]` | La tension arterielle minimale `r resume.RBP[["minimum"]]` mm Hg
| Maximum           |`r resume.RBP[["maximum"]]` mm Hg| La tension arterielle maximale est `r resume.RBP[["maximum"]]` mm Hg
| Moyenne           | `r round(resume.RBP[["moyenne"]])` mm Hg| En moyenne les individus ont une tension arterielle de `r round(resume.RBP[["moyenne"]])`     |
| Mode              | `r round(resume.RBP[["mode"]])` mm Hg| La majorite des individus ont une tension de `r round(resume.RBP[["mode"]])` mm Hg |
| 1er quartile (Q1) | `r round(resume.RBP[["quantile"]][1])` mm Hg| 25% des individus ont une tension dmoins `r round(resume.RBP[["quantile"]][1])` mm Hg |
| Mediane (Q2)      | `r round(resume.RBP[["quantile"]][2])` mm Hg| La moitie des individus ont une tension superieur a `r round(resume.RBP[["quantile"]][2])` mm Hg ou inferieur a `r round(resume.RBP[["quantile"]][2])` mm Hg |
| 3e quartile (Q3)  | `r round(resume.RBP[["quantile"]][3])` mm Hg| 75% des individus ont moins de `r round(resume.RBP[["quantile"]][3])` mm Hg         |

: Tableau recapitulatif de la Tension arterielle


## 3. Analyse et interpretation du taux de cholesterol des individus

L'organisme produit près de 75% du cholestérol.
Le reste provient de l'alimentation.
On le retrouve dans les produits d'origine animale (viande, charcuteries, laitages, abats...) ainsi que dans les œufs, poissons, crustacés.
Il est synthétisé en grande partie par le foie.
La régulation du cholestérol dépend donc de facteurs génétiques et de notre mode d'alimentation.

Il existe principalement deux types de cholesterol, le bon cholesterol(HDL) ou High Density Lipoprotein et le mauvais cholestrol(LDL) ou Low Density Lipoprotein.
Un équilibre approprié entre le LDL et le HDL est important pour maintenir la santé cardiovasculaire.
Des niveaux élevés de LDL et des niveaux bas de HDL peuvent augmenter le risque de maladies cardiovasculaires.

Le Cholesterol Total(CT) est la combinaison des deux sus-cites.
Le taux de cholestérol total ne devrait pas être supérieur à 200, voire 238 mg/dl.
Lorsque ce chiffre dépasse les 240 mg/dl, cela peut même s'avérer dangereux.

```{r echo=FALSE}
pt.chol <- ggplot(data = df)
Hist.chol <- pt.chol + 
  geom_histogram(mapping = aes(Cholesterol), colour = "white", fill = "yellow", bins = 10) +
  ylab("Nombre d'Individus") + 
  xlab("Taux de cholesterol en mg/dl") +
  ggtitle("HISTOGRAMME DU TAUX DE CHOLESTEROL") +
  theme(plot.title = element_text(hjust = 0.5))
Hist.chol
```

```{r echo=FALSE}
resume.chol <- akposso.qt.resume(df$Cholesterol)
```

Le niveau du taux de cholesterol des individus de notre population est compris entre `r resume.chol[["minimum"]]` mg/dl et `r resume.chol[["maximum"]]` mg/dl, alors que la valeur modale est de `r resume.chol[["mode"]]` mg/dl.
Cela met en exergue que la plupart des personnes ont un taux de cholesterol autour de la valeur normale qui est de 200 mg/dl.
Cependant, ce taux peut parfois atteindre 300 mg/dl, ce qui pourrait s averer tres dangeureux. 

Le taux moyen de cholesterol s eleve a `r round(resume.chol[["moyenne"]])` mg/dl, avec un ecart type d environ `r round(resume.chol[["ecart_type"]])` mg/dl.
Cette moyenne se situe dans la zone desirable du taux de cholesterol qui doit être inferieur a 200 mg/dl.
De plus, un individu sur quatre a au plus 173,25 mg/dl tandis qu un individu sur deux a un taux median de `r round(resume.chol[["mediane"]])` mg/dl ce qui est relativement au dessus de la norme avec plus de 23 mg/dl.

Le resume numerique suivant permet d'avoir plus d information sur la distribution

```{r}
resume.chol
```

## 4. Analyse et interpretation du rythme cardiaque maximum

La fréquence cardiaque maximale (FCM) est le rythme que le cœur humain d'une personne donnée atteint lors des plus fortes sollicitations.
Au repos, la fréquence cardiaque est environ de 60 à 80 battements par minute.

```{r echo=FALSE}
pt.hrm <- ggplot(data = dfquant)
Hist.hrm <- pt.hrm + 
  geom_histogram(mapping = aes(MaxHR), colour = "white", fill = "green", bins = 10) + 
  ylab("Nombre d'Individus") + 
  xlab("Nombre de battement par minute") +
  ggtitle("HISTOGRAMME DU RYTHME CARDIAQUE") +
  theme(plot.title = element_text(hjust = 0.5))
Hist.hrm
```

```{r echo=FALSE}
resume.hrm <- akposso.qt.resume(dfquant$MaxHR)
```

Le rythme cardiaque des individus soumis a notre etude est compris entre `r resume.hrm[["minimum"]]` et `r resume.hrm[["maximum"]]`, alors que la valeur modale est de `r resume.hrm[["mode"]]` .
Ce qui signifie que la plupart des ces personnes ont un rythme cardiaque qui s eleve a `r resume.hrm[["mode"]]` battement par minute.

Le nombre de battement moyen par minute du coeur est de `r round(resume.hrm[["moyenne"]])` , avec un ecart type d environ `r round(resume.hrm[["ecart_type"]])` battement par minute.

De plus, un individu sur quatre a au plus `r round(resume.hrm[["quantile"]][2])` battement par minute, tandis qu une personne sur deux a un taux median de `r round(resume.hrm[["mediane"]])` battement par minute.

La distribution est etalee a gauche avec un coefficient d assymetrie de `r round(resume.hrm$coefficient_assymetrie)`

Le tableau recapitulatif suivant permet d avoir de plus amples informations sur la repartition de cette population.

```{r echo=FALSE}
resume.hrm
```

## 5. Analyse et interpretation de la mesure sur l'électrocardiogramme

La mesure sur l'électrocardiogramme (ECG) appelée "Oldpeak" est généralement exprimée en millimètres et représente la différence entre le point le plus bas du segment ST pendant l'exercice et la ligne de base (point de départ) de l'ECG.
C est un indicateur de la réponse électrique du cœur pendant l'effort et peut être utilisé pour évaluer la présence d'ischémie cardiaque, ce qui peut être un signe de maladie coronarienne.
Une valeur élevée peut être un indicateur de risque de maladie cardiaque.

```{r echo=FALSE}
pt.odp <- ggplot(data = df)
Hist.odp <- pt.odp + 
  geom_histogram(mapping = aes(df$Oldpeak), colour = "white", fill = "grey", bins = 10) + 
  ylab("Nombre d'Individus") + 
  xlab("Ecart (mm)") +
  ggtitle("HISTOGRAMME DE LA MESURE DE L'ECG") +
  theme(plot.title = element_text(hjust = 0.5))
Hist.odp
```

```{r echo=FALSE}
resume.odp <- akposso.qt.resume(df$Oldpeak)
```

la mesure sur l'électrocardiogramme oscille entre `r resume.odp[["minimum"]]` mm et `r resume.odp[["maximum"]]` mm, alors que la valeur modale est d environ `r round(resume.odp[["mode"]])`.
Ce qui signifie que la plupart de ces personnes ont un Oldpeak qui s eleve a `r resume.odp[["mode"]]` mm, cela indique que la majorite des individus n ont pas un risque de maladie cardiaque eleve car cette valeur est tres faible.

La moyenne des individus ont une valeur egale a `r round(resume.odp[["moyenne"]])` , avec un ecart type d environ `r round(resume.odp[["ecart_type"]])`.
C est a dire que la mesure du segment est compris entre -0,12 mm et 2,54 mm.

De plus, un individu sur quatre a au plus `r round(resume.odp[["quantile"]][2])` mm, ce qui montre que le quart des individus ont un bon niveau, tandis qu une personne sur deux a `r round(resume.odp[["mediane"]])` mm, ce qui n est pas tres grave.

L histogramme et la valeur du coefficient d assymetrie (`r round(resume.odp$coefficient_assymetrie)`) montrent que la distribution est etalee a droite.
Le tableau recapitulatif suivant permet d avoir de plus amples informations sur la repartition de cette population.

```{r echo=FALSE}
resume.odp
```

## II. ANALYSE DES VARIABLES QUALITATIVES

Dans cette partie, il s agira de faire des graphiques, de calculer les indicateurs adaptes et de les interpreter.

### 1. Analyse de la variable Sexe

Le diagramme ci-dessous permet de mieux visualiser la reparition des patients par sexe.

```{r}
eff = table(df$Sex)
barplot(eff, col = rainbow(2), main = "REPARTITION DES PATIENTS PAR SEXE", horiz = TRUE, border = NA)
```
Notre jeu de donnees est compose majoritairement d homme en terme de proportion le tableau ci-dessous nous permet d affirmer que *79% d'individus sont de sexe masculin et que 21% sont de sexe feminin*.

```{r echo=FALSE}
tab.sex <- akposso.ql.tableau(df$Sex)
tab.sex
```

## 2. Analyse de la variable ChestPaintype

```{r echo=FALSE}
eff.cpt = table(df$ChestPainType)
barplot(eff.cpt, col = rainbow(10), main = "REPARTITION DES PATIENTS PAR TYPE DE DOULEUR THORACIQUE", horiz = FALSE, border = NA)
```
La taille des barres met en exergue que la majorite des patients ont une douleur thoracique de type asymptomatique (ASY), c est a dire qu ils ne manifestent pas de symptôme.
Ensuite, viennent les patients qui ont d autres type de douleur (NAP) suivi de ceux qui ont des douleurs de type atypique (ATA), en d autres termes, ces douleurs sont different du type habituel. Enfin, c est seulement une minorite qui presente des douleurs de poitrine typique (TA).

Le tableau statistique ci-dessous nous donne les proportions suivantes: 54% des patients ne presentent pas de symptome d angine de poitrine.
Concernant l Angine de poitrine atypique (ATA), 18,84% des individus en souffre.
Enfin, les patients presentant l Angine de poitrine (TA) et des Douleurs autres que l'angine (NAP) sont respectivement de 5% et 22,11%.

```{r echo=FALSE}
tab.cpt <- akposso.ql.tableau(df$ChestPainType)
knitr::kable(tab.cpt, caption = "TABLEAU DE LA VARIABLE CHESTPAINTYPE", )
```

En resume, la majorite des patients ne presentent pas de symptôme d angine de poitrine.

## 3. Analyse de la variable RestingECG

```{r}
eff.RECG = table(df$RestingECG)
barplot(eff.RECG, col = rainbow(10), main = "REPARTITION DES PATIENTS PAR RESULTAT DE ECG", horiz = TRUE, border = NA)
```
Le graphique nous permet de constater que la plupart des patients sont dans une situation normale suite au test de l ECG au repos. 
Le tableau statistique ci-dessous nous confirme ce fait avec plus de *60% qui ont un rythme cardiaque normal*.

De plus, *20,47 % presentent une hypertrophie ventriculaire gauche (LVH )* qui peut être associé à des problèmes de santé tels que des maladies cardiaques, des valvulopathies, ou d'autres conditions médicales.

Enfin, *19,39% ont ete diagnostique d une anomalie au niveau du segment ST-T* ce qui pourrait avoir des raisons diverses: \* Ischémie myocardique: une diminution de l'apport sanguin au muscle cardiaque \* Infarctus du myocarde ou crise cardiaque \* Angine de poitrine stable ou instable du a une dépression du segment ST ou une elevation \* ...

```{r echo=FALSE}
tab.RECG <- akposso.ql.tableau(df$RestingECG)
knitr::kable(tab.RECG, caption = "TABLEAU STATISTIQUE DE L ECG AU REPOS", )
```


## 4. Analyse et interpretation de la glycémie à jeun.

Le taux de glycémie à jeun est la concentration de glucose (sucre) dans le sang après une période de jeûne, généralement d'au moins 8 heures.
Cette mesure est souvent utilisée pour évaluer le métabolisme du glucose et le risque de diabète.

```{r echo=FALSE}
eff.FBS = table(df$FastingBS)
pie(eff.FBS, col = rainbow(10), main = "REPARTITION DES PATIENTS PAR GLYCEMIE", border = NA)
```
Il est aisement visible sur la representation graphique que plus des deux-tier (2/3) des patients ont une glycemie a jeun inferieur a 120 mg/dl.

Le tableau des frequences ci-dessous permet de quantifier cette observation. Le taux d individus ayant leur *glycemie a jeun superieur a 120 mg/dl est de 23%*, c'est a dire que ces derniers ont le *Diabete.*
plus de *77% ont un taux inferieur a 120 mg/dl*, ce qui signifie qu ils sont soit dans la zone de *Prédiabete ou dans la zone Normale*.

```{r echo=FALSE}
tab.FBS <- akposso.ql.tableau(df$FastingBS)
knitr::kable(tab.FBS, caption = "TABLEAU STATISTIQUE DU TAUX DE GLYCEMIE A JEUN", )
```

## 5. Analyse et interpretation de l Angine induite par L exercice.

L'angine induite par l'exercice, également appelée angine d'effort, est une douleur thoracique ou un inconfort qui se produit pendant l'activité physique ou peu de temps après.
Elle est généralement causée par un apport sanguin insuffisant au muscle cardiaque (ischémie) en raison d'une maladie coronarienne sous-jacente.

```{r echo=FALSE}
eff.EA = table(df$ExerciseAngina)
pie(eff.EA, col = rainbow(2), main = "REPARTITION DES ANGINES INDUITES PAR EXERCICE", border = NA)
```

Le diagramme circulaire et le tableau statistique nous permettent d affirmer sans doute que parmi nos individus, *59,59 % n ont pas une angine induite par l'exercice*, c est a dire quils ne ressentent pas de douleur thoracique ou d inconfort qui se produit pendant l'activité physique ou peu de temps après.
Cependant, 40,41 % reconnaissent avoir une angine induite par l'exercice.

```{r echo=FALSE}
tab.EA <- akposso.ql.tableau(df$ExerciseAngina)
knitr::kable(tab.EA, caption = "TABLEAU STATISTIQUE D'ANGINE DU A EXERCICE")
```

## 6. Analyse et interpretation de la forme du Segment ST.

L'interprétation de la pente du segment ST sur un électrocardiogramme (ECG) est importante pour évaluer la présence d'anomalies cardiaques.
Le segment ST est la portion du tracé de l'ECG située entre la fin du complexe QRS et le début de l'onde T.
La pente du segment ST peut être classée en trois catégories principales : ascendant (positif), descendant (négatif), ou horizontal (isoélectrique).
Elles sont representes ici, respectivement par: Up, Down et Flat.

```{r echo=FALSE}
tab.Sl <- akposso.ql.tableau(df$ST_Slope)
knitr::kable(tab.Sl, caption = "TABLEAU STATISTIQUE DE LA FORME DES COURBES")
```

Parmi nos individus, environ *50 % ont une forme de segment ST plate*, ce qui indique une situation normale de la sante cardiaque.
Cependant, *43 % ont une courbe ascendante* pouvant indiquer une ischémie myocardique, surtout si elle est accompagnée de symptômes tels que la douleur thoracique.
Cela peut être observé dans des conditions telles que l'angine de poitrine ou pendant un test d'effort.
Seulement *7 % des courbes ont une forme decendante (Down)*, cela peut être observé lors d'un infarctus du myocarde (crise cardiaque).

Cette conclusion est aisement visible sur le graphique ci-dessous:

```{r echo=FALSE}
eff.Sl = table(df$ST_Slope)
barplot(eff.Sl, col = rainbow(23), main = "REPARTITION PAR FORME DE SEGMENT ST", border = NA)
```

## 7. Analyse et interpretation de la presence ou pas de maladie cardiaque.

Les maladies cardiaques, également connues sous le nom de maladies cardiovasculaires, englobent un large éventail de troubles affectant le cœur et les vaisseaux sanguins.
Ces affections peuvent avoir des causes diverses, notamment des facteurs génétiques, des modes de vie malsains et d'autres conditions médicales.

Le diagramme ci-dessous nous permet de visualiser la presence ou l absence de maladie cardiaque chez les patients enquetes.

```{r echo=FALSE}
eff.HD = table(df$HeartDisease)
pie(eff.HD, col = rainbow(2), main = "REPARTITION PAR PRESENCE DE MALADIE", border = NA)
```
Nous pouvant constater qu un peu plus de la moitie des patients ont une maladie cardiaque, les chiffres du tableau nous permettrons de savoir la repartition chiffree des patients en fonction de la presence ou non de maladie cardiaque.

```{r echo=FALSE}
tab.HD <- akposso.ql.tableau(df$HeartDisease)
knitr::kable(tab.HD, caption = "TABLEAU STATISTIQUE DES MALADIES CARDIAQUES")
```

De facon chiffree, plus de 55 % des patients souffre de maladie du coeur tandis que 44 % n en souffre pas. 

### Conclusion
Au terme de cette partie, nous retenons que notre jeu de donnees est compose de 918 patients qui sont a 79% des hommes adultes.
Ces patients sont a 23% des malades de diabete et a 55% des malades cardiaques.
Dans la suite de notre analyse, il s agira de determiner les facteurs qui sont lies aux maladies cardiaques et de montrer les proportions de ces liaisons.

# TROISIEME PARTIE: ANALYSE BIVARIEE

### Introduction
Dans Cette derniere partie, nous allons evaluer l effet des onze autres variables sur les maladies du coeurs (HeartDisease). 
Par ailleurs, nous determinerons a l aide des indicateurs, les facteurs qui sont les plus lies aux maladies cardiaques grâce aux indicateurs de correlation.

### I. Analyse bivariee des variables quantitatives

### 1. Les maladies cardiaques sont elles influencees par l ages?
#### a. Analyse graphique

```{r echo=FALSE}
ggplot(df, aes(HeartDisease, Age)) +
geom_boxplot(color = c("green", "red"), fill = c("orange", "skyblue")) +
ggtitle(label = "LIAISON ENTRE MALADIE CARDIAQUE ET AGE", ) +
  theme(plot.title = element_text(hjust = 0.5))
```

La representation ci-dessus nous montre l'existence d'une liaison entre la presence ou non de maladies du coeur et l âge des patients.
Afin d avoir une idee plus claire de cette situation, nous allons calculer le rapport de correlation.

#### b. Analyse par des indicateurs

```{r echo=FALSE}
rap.cor <- akposso.qtql.liaison(df$Age, df$HeartDisease)
rap.cor
```

Suite au calcul de ce rapport, il resort qu il existe une liaison entre ces deux variables, cependant, la valeur du rapport de correlation (`r round(rap.cor$Rapport_Correlation)`) indique une *intensite de liaison très faible*.
Par consequent, les maladies cardiaques sont expliquees dans de faibles proportions par l'âge des personnes. 

### 2. Les maladies cardiaques sont elles influencees par la Pression arterielle au repos?
#### a. Analyse graphique

```{r echo=FALSE}
ggplot(df, aes(HeartDisease, RestingBP)) +
geom_boxplot(color = c("green", "red"), fill = c("orange", "skyblue")) +
  ggtitle(label = "LIAISON ENTRE MALADIE CARDIAQUE ET PRESSION ARTERIELLE AU REPOS") +
  theme(plot.title = element_text(hjust = 0.5))
```

La representation ci-dessus nous autorise a soupconner l'existence d'une liaison entre la presence des malaidies du coeur et les valeurs de la pression cardiaque au repos des patients.

Cela s'explique par le fait que nous constatons une variation de tailles de la boîte en fonction de l'existence ou non de maladie cardiaque.
La mediane au niveau de ceux qui ont la maladie est un peu plus au dessus de ceux qui ne l'ont pas.

Ces variations montrent prouve la probable relation entre les deux faits.
Afin d avoir une idee plus claire de cette situation, nous allons calculer le rapport de correlation.

#### b. Analyse par des indicateurs

```{r echo=FALSE}
rap.cor <- akposso.qtql.liaison(df$RestingBP, df$HeartDisease)
rap.cor
```

Suite au calcul de ce rapport, il resort qu'il existe une liaison entre ces deux variables, cependant, *l intensite de cette liaison est tres faible* avec une valeur du rapport de correlation egale a (`r round(rap.cor$Rapport_Correlation)`).
Par consequent, *le niveau de la pression arterielle au repos explique très faiblement l'existence d'une maladie cardiaque*.


### 3. Les maladies cardiaques sont-elles influencées par le taux de Cholesterol?
#### a. Analyse graphique


```{r echo=FALSE}
ggplot(df, aes(HeartDisease, Cholesterol)) +
geom_boxplot(color = c("green", "red"), fill = c("orange", "skyblue")) +
  ggtitle(label = "LIAISON ENTRE MALADIE CARDIAQUE ET TAUX DE CHOLESTEROL") +
  theme(plot.title = element_text(hjust = 0.5))
```

La representation ci-dessus nous autorise a soupconner l'existence d'une liaison entre la présence des maladies cardiaques et le taux de Cholesterol des patients.
Nous constatons une variation de tailles de la boîte en fonction de l'existence ou non de la maladie.
La mediane au niveau de ceux qui ont la maladie est legerement en dessous de ceux qui n'en n'ont pas et le nombre d'individus dont le taux est inferieur a la mediane augmente drastiquement (voir la boîte a moustache en Bleu).

#### b. Analyse par des indicateurs

Afin d avoir une idee plus claire de cette situation, nous allons calculer le rapport de correlation.

```{r echo=FALSE}
rap.cor <- akposso.qtql.liaison(df$Cholesterol, df$HeartDisease)
rap.cor
```

Suite au calcul de cet indicateur donne une valeur égale à (`{r round(rap.cor$Rapport_Correlation)`). il resort qu'il existe une liaison entre ces deux variables, avec *une intensite très faible*.
En claire, *le niveau du taux de cholestérol explique faiblement l'existence d'une maladie cardiaque*.



### 4. Les maladies cardiaques sont-elles influencées par le rythme cardiaque maximum?
#### a. Analyse graphique

```{r echo=FALSE}
ggplot(df, aes(HeartDisease, MaxHR)) +
geom_boxplot(color = c("green", "red"), fill = c("orange", "skyblue")) +
  ggtitle(label = "LIAISON ENTRE MALADIE CARDIAQUE ET RYTHME CARDIAQUE MAXIMUM") +
  theme(plot.title = element_text(hjust = 0.5))
```

La representation ci-dessus nous permet de constater l'existence d'une liaison entre la présence de maladies cardiaques et le niveau maximum du rythme cardiaque des patients.
Nous constatons un changement de position de la boîte en fonction de l'existence ou non de maladie cardiaque.
La mediane au niveau de ceux qui ont la maladie est un peu plus basse que celle de ceux ne l'ont pas.

#### b. Analyse par des indicateurs

Afin d'avoir une idée plus claire de cette situation, nous allons calculer le rapport de corrélation.

```{r echo=FALSE}
rap.cor <- akposso.qtql.liaison(df$MaxHR, df$HeartDisease)
rap.cor
```

Suite au calcul de ce rapport, il resort qu'il existe une liaison entre ces deux variables, cependant, *l'intensite de cette liaison est faible* avec une valeur du rapport de correlation égale à (`{r rap.cor$Rapport_Correlation}`).
Par consequent, *le rythme cardiaque maximum explique faiblement l'existence d'un maladie cardiaque*.



### 5. Les maladies cardiaques sont-elles influencées par la mésure sur l'électrocardiogramme(ECG) ?
#### a. Analyse graphique

```{r echo=FALSE}
ggplot(df, aes(HeartDisease, Oldpeak)) +
geom_boxplot(color = c("green", "red"), fill = c("orange", "skyblue")) +
  ggtitle(label = "LIAISON ENTRE MALADIE CARDIAQUE ET MESURE SUR ECG") +
  theme(plot.title = element_text(hjust = 0.5))
```

La representation ci-dessus nous autorise a soupconner l'existence d'une liaison entre la presence des maladies cardiaques et le niveau maximum du rythme cardiaque des patients.
Nous constatons un changement de position et de taille des boîtes en fonction de l'existence ou non de la maladie.
La mediane au niveau de ceux qui ont la maladie est un peu plus basse que celle de ceux ne l'ont pas.

#### b. Analyse par des indicateurs

Afin d'avoir une idée plus claire de cette situation, nous allons calculer le rapport de correlation.

```{r echo=FALSE}
rap.cor <- akposso.qtql.liaison(df$Oldpeak, df$HeartDisease)
rap.cor
```

Suite au calcul de ce rapport, il resort qu il existe une liaison entre ces deux variables, cependant, *l'intensite de cette liaison est faible* avec une valeur du rapport de correlation égale à (`r round(rap.cor$Rapport_Correlation)`).
Par consequent, *la mesure sur l'électrocardiogramme explique faiblement l'existence d une maladie cardiaque*.



## II. Liaison entre Les maladies cardiaques et les variables qualitatives

### 1. Les maladies cardiaques sont-elles influencées par le genre?
## a. Analyse graphique

Debutons par visualiser la repartition des maladies du coeur par sexe grâce à des diagrammes.

```{r echo=FALSE}
par(mfrow=c(1, 2))
ggplot(df, aes(x = factor(Sex, labels = c("Femme", "Homme")))) +
  geom_bar(aes(fill = factor(HeartDisease, labels = c("Oui", "Non"))), position = "dodge")+
  labs(x = "Sexe", fill = "Heart Disease")

plot(table(df$HeartDisease, df$Sex),main="GRAPHIQUE",col=c("orange","blue"))
```

Ces graphiques nous donnes une idée de la liaison entre ces deux variables: *les individus de sexe masculin semble être plus sensible aux maladies cardiaques*.
Dans le but de clarifier cette probable relation, nous allons analyser le tableau des frequences, le tableau des profils et calculer les indicateurs de liaison qui sont le V de Cramer et le Khi-deux.

## b. Analyse par des indicateurs
```{r}
tab.genre <- akposso.2ql.tableau(df$HeartDisease, df$Sex)
```

```{r echo=FALSE}
par(mfrow=c(1, 2))
knitr::kable(tab.genre$Tableau_Contingence, caption = "TABLEAU DE CONTINGENCE")
knitr::kable(tab.genre$Tableau_Frequence, caption = "TABLEAU DE FREQUENCE")
knitr::kable(tab.genre$Tableau_Profil_Ligne, caption = "TABLEAU DES PROFILS LIGNES")
knitr::kable(tab.genre$Tableau_Profil_Colonne, caption = "TABLEAU DES PROFILS COLONNES")
```

L'analyse de ces tableaux montre que *50% de l'ensemble des individus sont de sexe masculin et ont une maladie cardiaque* tandis 5% seulement sont des femmes et sont malades.

De plus, le tableau des profils lignes montre que 90% des malades sont des hommes, tandis que 10% seulement sont des femmes.
Ce qui renforce nos resultats soupconnés au niveau de l'analyse graphique.

```{r echo=FALSE}
akposso.2ql.liaison(df$HeartDisease, df$Sex)
```

Le calcul des indicateurs de correlation ci-dessus viennent confirmer et renforcer la pertinence des resultats obtenus précédemment.
Par conséquent, *il existe une liaison significative mais faible* entre l'existence des maladies cardiaques et le genre des individus.

### 2. Les maladies cardiaques sont-elles influencées par l'Angine de poitrine?
#### a. Analyse graphique

Debutons par visualiser la repartition des maladies du coeur par Angine de poitrine.
```{r echo=FALSE}
par(mfrow=c(1, 2))
ggplot(df, aes(x = factor(ChestPainType))) +
  geom_bar(aes(fill = factor(HeartDisease, labels = c("Non", "Oui"))), position = "dodge")+
  labs(x = "Angine de poitrine", fill = "Heart Disease")

plot(table(df$HeartDisease, df$ChestPainType),main="GRAPHIQUE",col=c("orange","blue", "skyblue", "green"), border = NA)
```

Ces graphiques nous donnes une idee de la liaison entre ces deux variables: *les individus ne presentant pas de symptôme d'angine de poitrine semblent être plus sensible aux maladies cardiaques*.
Dans le but de clarifier cette probable relation, nous allons analyser les tableaux de contingence, de fréquence et des profils et calculer les indicateurs de liaison qui sont le V de Cramer et le Khi-deux.

#### b. Analyse par des indicateurs

#### \* Tableau statistique

```{r echo=FALSE}
tab.cpt <- akposso.2ql.tableau(df$HeartDisease, df$ChestPainType)
```

```{r echo=FALSE}
par(mfrow=c(2, 2))
knitr::kable(tab.cpt$Tableau_Contingence, caption = "TABLEAU DE CONTINGENCE")
knitr::kable(tab.cpt$Tableau_Frequence, caption = "TABLEAU DE FREQUENCE")
knitr::kable(tab.cpt$Tableau_Profil_Ligne, caption = "TABLEAU DES PROFILS LIGNES")
knitr::kable(tab.cpt$Tableau_Profil_Colonne, caption = "TABLEAU DES PROFILS COLONNES")
```

L'analyse de ces deux tableaux montre que 43% de l ensemble des patients ont une maladie du coeur sans symptome d'angine de poitrine.
Aussi, 8% de l'ensemble des patients ont une maladie du coeur accompagnée de types de douleurs autres que celles du à l'angine de poitrine (NAP).
En ce qui concerne la relation entre les maladies cardiaques et les douleurs du à l angine de poitrine, seulement 3% des patients presentent cette maladie accompagnée d'une angine de poitrine atypique (ATA) et 2% d'une angine de poitrine typique (AT).
Cela represente respectivement 5% et 4% des individus malades cardiques.
Alors que ceux n'ayant *pas de symptome representent 77% des malades* et ceux ayant des douleurs autre que l'angine ont une proportion de 14% des malades cardiaques.

#### \* Indicateur de liaison

```{r echo=FALSE}
akposso.2ql.liaison(df$HeartDisease, df$ChestPainType)
```

Le calcul des indicateurs de correlation de Khi-deux et le V de cramer permettent de déterminer la vrai nature de la liaison entre les maladies du coeur et l'Angine de poitrine.
Par conséquent, *il existe une liaison significative d'intensitée moyenne* entre l'existence des maladies cardiaques et l'Angine de poitrine.


### 3. Les maladies cardiaques sont elles influencees par la glycémie à jeun?
#### a. Analyse graphique

Débutons par visualiser la repartition des maladies du coeur par rapport a la glycémie à jeun.

```{r echo=FALSE}
par(mfrow=c(1, 2))
ggplot(df, aes(x = factor(FastingBS))) +
  geom_bar(aes(fill = factor(HeartDisease, labels = c("Non", "Oui"))), position = "dodge")+
  labs(x = "glycemie a jeun", fill = "Maladie Cardiaque")

plot(table(df$HeartDisease, df$FastingBS),main="GRAPHIQUE",col=c("blue", "red"), border = NA)
```

Ces graphiques nous donnes un aperçu de la liaison entre ces deux variables.
Tout d'abord, FastingBS \> 120 mg/dl signifie que la glycémie à jeun est superieur a 120 mg/dl ce qui est synonyme de prèsence de diabète chez le patient.

Certes, la visualisation des graphiques ci-dessus montre que la majorité des personnes ne présentant pas de maladie cardiaque n'ont pas de diabète ( glycémie à jeun est inferieur a 120 mg/dl), mais la proportion des malades cardiaques ayant diabète est plus grande que celle des personnes saines ayant le diabète, ce qui nous permet de soupconner que: *les individus ayant le diabète semblent être plus sensible aux maladies cardiaques*.

Dans le but de clarifier cette probable relation, nous allons analyser le tableau de contingence, le tableau de frequence et des profils et calculer les indicateurs de liaison qui sont le V de Cramer et le Khi-deux.

#### b. Analyse par des indicateurs

##### \* Tableau statistique

```{r echo=FALSE}
tab.fbs <- akposso.2ql.tableau(df$HeartDisease, df$FastingBS)
```

```{r echo=FALSE}
par(mfrow=c(2, 2))
knitr::kable(tab.fbs$Tableau_Contingence, caption = "TABLEAU DE CONTINGENCE")
knitr::kable(tab.fbs$Tableau_Frequence, caption = "TABLEAU DE FREQUENCE")
knitr::kable(tab.fbs$Tableau_Profil_Ligne, caption = "TABLEAU DES PROFILS LIGNES")
knitr::kable(tab.fbs$Tableau_Profil_Colonne, caption = "TABLEAU DES PROFILS COLONNES")
```

L analyse de ces tableaux montre que 37% de l ensemble des patients ont une maladie du coeur et n ont pas le diabète.
Aussi, seulement 5% de l ensemble des patients ont le diabète sans avoir de maladie cardiaque alors que 19% des individus presentent les deux maladies.
L analyse du tableau des profils colonnes met en lumiere que *79 diabetiques sur cent ont une maladie cardiaque*, ce qui est très évocateur et nécessite un approfondissement afin d'en cerner les tenants et aboutssants.

##### \* Indicateur de liaison

```{r echo=FALSE}
li.fbs <- akposso.2ql.liaison(df$HeartDisease, df$FastingBS)
li.fbs
```

Le calcul des indicateurs de correlation de Khi-deux et le V de cramer permettent determiner la vrai nature de la liaison entre les maladies du coeur et le diabète.
Par consequent, *il existe une liaison significative d'intensitée faible* entre l'existence des maladies cardiaques et le diabète.
Mais, la valeur du V de cramer (`r li.fbs$V_Cramer`) est relativement élevé par rapport a celle des autres variables calculées précédemment.

### 4. Les maladies cardiaques sont-elles influencées par le resultat de l'électrocardiogramme?

#### a. Analyse graphique

Débutons par visualiser la repartition des maladies du coeur par rapport au resultat de l'électrocardiogramme grâce à des diagrammes en bar.

```{r echo=FALSE}
par(mfrow=c(1, 2))
ggplot(df, aes(x = factor(RestingECG))) +
  geom_bar(aes(fill = factor(HeartDisease, labels = c("Non", "Oui"))), position = "dodge")+
  labs(x = "ECG au Repos", fill = "Heart Disease")
plot(table(df$HeartDisease, df$RestingECG),main="GRAPHIQUE",col=c("orange","blue", "skyblue"), border = NA)
```

Ces graphiques nous montre que la grande majorité des malades présentent une activité électrique du cœur se trouvant dans les limites normales, sans anomalies significatives (Barres du milieu).

Cependant, les barres de droite et de gauche sont synonymes de maladies liées au coeur.
Les patients presentant une anomalie au niveau du segement ST et ayant une maladie sont relativement élevés par rapport à ceux qui n'ont pas la maladie et qui ont une anomalie, ce raisonnement est applicable aussi au LVH.

Dans le but de clarifier cette probable relation, nous allons analyser le tableau de contingence, le tableau de frequence et des profils et calculer les indicateurs de liaison qui sont le V de Cramer et le Khi-deux.

#### b. Analyse par des indicateurs

#### \* Tableau statistique

```{r echo=FALSE}
tab.ecg <- akposso.2ql.tableau(df$HeartDisease, df$RestingECG)
```

```{r echo=FALSE}
par(mfrow=c(2, 2))
knitr::kable(tab.ecg$Tableau_Contingence, caption = "TABLEAU DE CONTINGENCE")
knitr::kable(tab.ecg$Tableau_Frequence, caption = "TABLEAU DE FREQUENCE")
knitr::kable(tab.ecg$Tableau_Profil_Ligne, caption = "TABLEAU DES PROFILS LIGNES")
knitr::kable(tab.ecg$Tableau_Profil_Colonne, caption = "TABLEAU DES PROFILS COLONNES")
```
Le tableau des fréquences montre que 31% des patients ont une maladie cardiaque et se situent dans la zone normale de la mésure de l'ECG. 

Relativement aux patients ayant une Hypertrophie du ventricule gauche (LVH) et une anomalie du segment ST accompagnés de maladie cardiaque, leur proportion est respectivement de 12% et 13%.

Par ailleurs, 56%  de ceux qui ont une Hypertrophie du ventricule gauche (LVH) ont une maladie cardiaque. Egalement, 66% des patients ayant une anomalie au niveau du segment ST sont des malades cardiaque. Aussi, 52% des patients qui ont un ECG normal sont malades.

#### \* Indicateur de liaison

```{r echo=FALSE}
akposso.2ql.liaison(df$HeartDisease, df$RestingECG)
```

Le calcul des indicateurs de correlation de Khi-deux et le V de cramer permettent déterminer la vrai nature de la liaison entre les maladies du coeur et l'Angine de poitrine.
Par consequent, *il existe une liaison significative d'intensitée faible* entre l'existence des maladies cardiaques et la nature de la mésure sur l'ECG.

### 5. Les maladies cardiaques sont elles influencees par la pente de l'ECG?

#### a. Analyse graphique

Debutons par visualiser la repartition des maladies du coeur par rapport au resultat de l'électrocardiogramme grâce à un diagramme en bar.

```{r echo=FALSE}
par(mfrow=c(1, 2))
ggplot(df, aes(x = factor(ST_Slope))) +
  geom_bar(aes(fill = factor(HeartDisease, labels = c("Non", "Oui"))), position = "dodge")+
  labs(x = "ECG au Repos", fill = "Heart Disease")
plot(table(df$HeartDisease, df$ST_Slope),main="GRAPHIQUE",col=c("orange","blue", "skyblue"), border = NA)
```

Ces graphiques nous montre que la grande majorité des malades ont une pente du segment ST de forme plate (voir les barres du milieu).
Ce qui denote que les malades qui ont une courbe plate sur l'ECG ont des maladies cardiaques.

Cependant, les barres de droite et de gauche sont synonymes de maladies liées au coeur.
Les patients presentant *Une élévation du segment ST* peuvent être associées à des conditions telles qu'un infarctus du myocarde.

Aussi, les individus qui ont une *dépression du segment ST* peuvent être associées à diverses conditions, y compris une ischémie myocardique (manque d'apport sanguin au muscle cardiaque).

Dans le but de clarifier cette probable relation, nous allons analyser le tableau de contingence, le tableau de frequence et des profils et calculer les indicateurs de liaison qui sont le V de Cramer et le Khi-deux.

#### b. Analyse par des indicateurs

#### \* Tableau statistique

```{r echo=FALSE}
tab.sts <- akposso.2ql.tableau(df$HeartDisease, df$ST_Slope)
```

```{r echo=FALSE}
par(mfrow=c(2, 2))
knitr::kable(tab.sts$Tableau_Contingence, caption = "TABLEAU DE CONTINGENCE")
knitr::kable(tab.sts$Tableau_Frequence, caption = "TABLEAU DE FREQUENCE")
knitr::kable(tab.sts$Tableau_Profil_Colonne, caption = "TABLEAU DES PROFILS COLONNES")
```

L'analyse des tableaux ci-dessus montre que 42% de l'ensemble des patients ont une maladie du coeur et une forme du segment ST normale (plate).
De plus, 8% de l'ensemble des patients ont une maladie du coeur avec une forme ascendante du segment ST. 
Nous pouvons aisement remarquer dans le tableau des profils colonnes, que 83% des individus qui ont une pente plate du segment ST ont des maladies cardiaques.

Par ailleurs, *78% de ceux qui ont une depression du segment ST ont une maladie cardiaque* et seulement 20% des patients qui ont une élévation du segment ST ont une maladie cardiaque.
Ces derniers resultats sont associes a des maladies telles que: l'infarctus du myocarde ou une ischémie myocardique (manque d'apport sanguin au muscle cardiaque).

#### \* Indicateur de liaison

```{r echo=FALSE}
st.hd <- akposso.2ql.liaison(df$HeartDisease, df$ST_Slope)
st.hd
```

Le calcul des indicateurs de correlation de Khi-deux et le V de cramer permettent de determiner la vrai nature de la liaison entre les maladies du coeur et la forme du segment ST. La valeur du V de cramer est `r round(st.hd$V_Cramer)` ce qui est très élevé et est synonyme d'une forte liaison entre la forme du segment ST et les maladies cardiaques.

### 6. Les maladies cardiaques sont elles influencees par l'Angine causée par l'excercice?
#### a. Analyse graphique

Debutons par visualiser la repartition des maladies du coeur par rapport l'Angine causée par l'exercice grâce à des diagrammes.

```{r echo=FALSE}
par(mfrow=c(1, 2))
ggplot(df, aes(x = factor(ExerciseAngina))) +
  geom_bar(aes(fill = factor(HeartDisease, labels = c("Non", "Oui"))), position = "dodge")+
  labs(x = "Angine Causee par exercice", fill = "Heart Disease")

plot(table(df$HeartDisease, df$ExerciseAngina),main="GRAPHIQUE",col=c("orange","blue"), border = NA)
```

Ces graphiques nous donnes une idée de la liaison entre ces deux variables: *les individus presentant des angines après effort sont majoritairement plus sensible aux maladies cardiaques*.
Dans le but de clarifier cette probable relation, nous allons analyser le tableau de contingence, le tableau de frequence et des profils et calculer les indicateurs de liaison qui sont le V de Cramer et le Khi-deux.

#### b. Analyse par des indicateurs

#### \* Tableau statistique

```{r echo=FALSE}
tab.exo <- akposso.2ql.tableau(df$HeartDisease, df$ExerciseAngina)
```



```{r echo=FALSE}
par(mfrow=c(2, 2))
knitr::kable(tab.exo$Tableau_Contingence, caption = "TABLEAU DE CONTINGENCE")
knitr::kable(tab.exo$Tableau_Frequence, caption = "TABLEAU DE FREQUENCE")
knitr::kable(tab.exo$Tableau_Profil_Ligne, caption = "TABLEAU DES PROFILS LIGNES")
knitr::kable(tab.exo$Tableau_Profil_Colonne, caption = "TABLEAU DES PROFILS COLONNES")
```

L'analyse de ces deux tableaux montre que *34% de l'ensemble des patients ont une maladie du coeur et une angine de poitrine après avoir fait une activité physique*.
Aussi, 21% de l'ensemble des patients ont une maladie du coeur sans angine de poitrine après exercice.

En ce qui concerne la relation entre les maladies cardiaques et les douleurs du à l'angine de poitrine suite a un effort physique, 62% des malades cardiques ont une angine de poitrine après avoir fait un effort, c'est a dire que plus de la moitié des malades du coeur présentent des douleurs thoraciques après un effort physique.
Alors que 38% des malades n'ont pas d'angine après exercices.

Par ailleurs, *85% des personnes ayant une angine suite a un exercice ont des maladies cardiaques.*

#### \* Indicateur de liaison

```{r}
akposso.2ql.liaison(df$HeartDisease, df$ExerciseAngina)

```

Le calcul des indicateurs de correlation de Khi-deux et le V de cramer permettent déterminer la vrai nature de la liaison entre les maladies du coeur et l'Angine de poitrine .
Par conséquent, *il existe une liaison significative d'intensitée moyenne* entre l'existence des maladies cardiaques et l'Angine de poitrine après exercice.

### Conclusion

Cette dernière partie avait pour objectif de mettre à nu les relations de corrélation qui pourraient exister entre les maladies du coeur et certains facteurs. 

Il en résulte que toutes les variables récoltées ont une influence sur la présence ou non de maladie cardiaque. 
Cependant, deux de nos variables dépendantes ont plus d'impacte sur l'existence de la maladie chez ces individus.

Celle qui a la plus forte corrélation est la forme de la pente du segment ST, ensuite vient l'Angine de poitrine après exercice avec une intensité moyenne.

# CONCLUSION GENERALE
En conclusion, notre étude a apporté des éclairages significatifs sur les facteurs contribuant au diagnostic des maladies cardiaques. 

L'analyse univariée a révélé plusieurs variables individuelles ayant une association marquée avec la présence de maladies cardiaques, fournissant ainsi des indications cruciales pour l'identification des patients à risque.
Cette première phase nous a permi de découvrir que globalement la majotité (79%) des patients sont de sexe masculin, ont un âge compris entre 44 ans et 63 ans et sont à 23% des diabétiques. 

L'exploration des relations bivariées a enrichi notre compréhension en mettant en évidence des interactions complexes entre divers facteurs et les maladies cardiaques. 
Nous avions onze (11) variables dépendantes, tous ces paramètres ont une liaison plus en moins fortes avec les maladies du coeur. 
Par contre, notre étude a révélé deux principaux éléments qui impactent le plus la présence ou l'absence de maladie cardiaque.
Le facteurs ayant une forte intensitée de liaison est la forme de la courbe du segment ST obtenue grâce à la mésure sur l'électrocardiogramme. 
Notre étude a montré que *78% de patients qui ont une depression du segment ST ont une maladie cardiaque* et 20% de ceux qui ont une élévation du segment ST ont une maladie cardiaque.
Ces derniers resultats sont associés à des maladies telles que: l'infarctus du myocarde ou une ischémie myocardique (manque d'apport sanguin au muscle cardiaque). Ce qui confirme la forte intensité de la relation qui existe entre les deux variables. 

Le second facteur influençant l'existence ou l'absence de maladie cardiaque est la presence de douleur thoracique juste après un effort.

L'analyse de la liaison montre ici que 85% des personnes ayant une angine suite à un exercice ont des maladies cardiaques. Et que 62% des malades cardiques ont une angine de poitrine après avoir fait un effort. 

Les résultats obtenus de notre étude portant sur les facteurs favorisant le diagnostic des maladies cardiaques sont conformes à la littérature médicale portant sur le sujet.
Ils viennent donc en complément à la documentation existante. Cependant, ces considérations soulignent la nécessité d'une interprétation prudente des résultats et de futures recherches pour affiner nos conclusions.




